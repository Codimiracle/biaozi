doctype 5
html
  head
    title 排课神器

    meta(charset='utf-8')
    meta(name='viewport', content='width=device-width, initial-scale=1.0')

    link(rel='stylesheet', href='/static/css/bootstrap.min.css')
    link(rel='stylesheet', href='/static/css/flat-ui.css')

    style.
      * {
        border-radius: 0 !important;
      }

      .navbar {
        padding: 0 20px;
        margin: 0;
      }

      .brand {
        color: #fff;
        line-height: 50px;
        margin: 0;
      }

      .logged {
        color: #ccc;
        font-size: 75%;
        line-height: 50px;
        margin: 0;
      }

      h2 {
        font-size: 120%;
        font-weight: normal;
        color: #fff;
        padding: 10px 20px;
        margin: 0;
      }

      .availables {
        position: absolute;
        left: 0;
        top: 50px;
        width: 200px;
        bottom: 0;
        overflow-y: scroll;
        list-style: none;
        margin: 0;
        padding: 0;
      }

      .availables li {
        display: block;
        color: #fff;
        cursor: pointer;
        margin: 0;
        padding: 10px 20px;
      }

      .availables li:hover {
        background: rgba(255, 255, 255, 0.1);
      }

      .availables li.selected {
        background: rgba(255, 255, 255, 0.2);
      }

      .selection {
        position: absolute;
        left: 200px;
        top: 50px;
        right: 0;
        bottom: 0;
        color: #000;
        font-size: 90%;
      }

      .selection table {
        width: 100%;
      }

      .selection th {
        text-align: center;
        padding: 5px;
        border: 1px solid #eee;
        font-weight: normal;
        vertical-align: top;
      }

      .selection td {
        border: 1px solid #eee;
        vertical-align: top;
      }

      .selection h3 {
        font-size: inherit;
      }

      .selection p {
        font-size: inherit;
      }

      .selection ul {
        list-style: none;
        margin: 0;
        padding: 0;
      }

      .selection ul li {
        display: block;
        margin: 0;
        padding: 0;
        height: 40px;
      }

      .selection ul li h3 {
        margin: 0;
        position: relative;
        z-index: 1;
        line-height: 20px;
        height: 20px;
        padding: 0 5px;
      }

      .selection ul li .details {
        margin: 0;
        position: relative;
        z-index: 1;
        line-height: 20px;
        height: 20px;
        padding: 0 5px;
      }

      .selection ul li .details span {
        margin-right: 1em;
      }

      .selection ul li .graph {
        white-space: nowrap;
        font-size: 0;
        margin: 0;
        position: relative;
        top: -40px;
        height: 40px;
      }

      .selection ul li .graph i {
        display: inline-block;
        height: 100%;
        width: 5%;
        background: rgba(255, 255, 255, 0.9);
      }

      .selection ul li .graph i.y {
        background: rgba(255, 255, 255, 0.7);
      }

  body
    div.navbar.navbar-inverse
      p.brand.pull-left 排课神器
      p.logged.pull-right
        | #{logged.username} &nbsp;
        a(href='/signout') 注销

    div.main
      ul.palette-peter-river.availables
        li 计算机编程基础
        li.selected Android 应用开发入门
        li Illustrator 软件应用
        li Photoshop 软件应用
        li.selected 苹果实用软件入门
        li.selected 企业级 Java I
        li 雕塑
        li 视听语言
        li 第二外语（日语）I
        li 计算机编程基础
        li Android 应用开发入门
        li Illustrator 软件应用
        li Photoshop 软件应用
        li 苹果实用软件入门
        li 企业级 Java I
        li 雕塑
        li 视听语言
        li 第二外语（日语）I
        li 计算机编程基础
        li Android 应用开发入门
        li Illustrator 软件应用
        li Photoshop 软件应用
        li 苹果实用软件入门
        li 企业级 Java I
        li 雕塑
        li 视听语言
        li 第二外语（日语）I
        li 计算机编程基础
        li Android 应用开发入门
        li Illustrator 软件应用
        li Photoshop 软件应用
        li 苹果实用软件入门
        li 企业级 Java I
        li 雕塑
        li 视听语言
        li 第二外语（日语）I
        li 计算机编程基础
        li Android 应用开发入门
        li Illustrator 软件应用
        li Photoshop 软件应用
        li 苹果实用软件入门
        li 企业级 Java I
        li 雕塑
        li 视听语言
        li 第二外语（日语）I

    div.selection
      table
        tr
          th
          th(width='18%') 周一
          th(width='18%') 周二
          th(width='18%') 周三
          th(width='18%') 周四
          th(width='18%') 周五

        times = [ '09:00 - 10:20', '10:40 - 12:00', '12:30 - 13:50', '14:00 - 15:20', '15:30 - 16:50', '17:00 - 18:20', '19:00 - 20:20', '20:30 - 21:50' ]

        each row, time in schedule
          tr
            th
              div #{time * 2 + 1} - #{time * 2 + 2}
              div #{times[time]}
            each cell in row
              td
                ul
                  each klass in cell
                    li(style='background:#F39C12')
                      week = klass.week
                      h3 #{klass.name}
                      p.details
                        span.class #{klass.code}
                        span.teacher #{klass.teacher}
                        span.weeks
                          if week.which
                            | 第 #{week.which} 周
                          else if week.weeks
                            | 第 #{week.weeks.join(' ')} 周
                          else if week.interval
                            case week.interval
                              when 1
                                | 第 #{week.start} - #{week.end} 周
                              when 2
                                if week.start % 2
                                  | 第 #{week.start} - #{week.end} 周单周
                                else
                                  | 第 #{week.start} - #{week.end} 周双周
                              default
                                | 第 #{week.start} - #{week.end} 周每隔 #{week.interval} 周
                        span.location #{klass.location}
                      p.graph
                        - var weeks = []
                        - for (var i = 0; i < 20; i++)
                          - weeks[i] = 0

                        if week.which
                          - weeks[week.which - 1] = 1
                        else if week.weeks
                          each w in week.weeks
                            - weeks[w - 1] = 1
                        else if week.interval
                          - for (var w = week.start; w <= week.end; w += week.interval)
                            - weeks[w - 1] = 1

                        each w in weeks
                          if w == 1
                            i.y
                          else
                            i
